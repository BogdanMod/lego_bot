exports.id=660,exports.ids=[660],exports.modules={56:(a,b,c)=>{Promise.resolve().then(c.bind(c,79772))},4441:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,21004,23)),Promise.resolve().then(c.t.bind(c,5303,23)),Promise.resolve().then(c.t.bind(c,54619,23)),Promise.resolve().then(c.t.bind(c,64174,23)),Promise.resolve().then(c.t.bind(c,11434,23)),Promise.resolve().then(c.t.bind(c,35438,23)),Promise.resolve().then(c.t.bind(c,9454,23)),Promise.resolve().then(c.t.bind(c,35915,23)),Promise.resolve().then(c.t.bind(c,89038,23))},8019:(a,b,c)=>{"use strict";c.d(b,{E:()=>f});var d=c(27986),e=c(19529);function f({variant:a="default",children:b,className:c}){return(0,d.jsx)("span",{className:(0,e.cn)("inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium",{"bg-slate-100 text-slate-800 dark:bg-slate-800 dark:text-slate-200":"default"===a,"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"success"===a,"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":"warning"===a,"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200":"danger"===a,"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":"info"===a},c),children:b})}},9784:(a,b,c)=>{Promise.resolve().then(c.bind(c,97623))},13009:(a,b,c)=>{"use strict";c.d(b,{Providers:()=>d});let d=(0,c(34372).registerClientReference)(function(){throw Error("Attempted to call Providers() from the server but Providers is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/bogdan.rudenko/Desktop/lego_bot-main/packages/owner-web/src/components/providers.tsx","Providers")},17763:(a,b,c)=>{"use strict";c.d(b,{Providers:()=>h});var d=c(27986),e=c(56789),f=c(43185),g=c(2603);function h({children:a}){let[b]=(0,g.useState)(()=>new e.E({defaultOptions:{queries:{staleTime:3e4,retry:1}}}));return(0,d.jsx)(f.Ht,{client:b,children:a})}},19529:(a,b,c)=>{"use strict";c.d(b,{cn:()=>f});var d=c(8942),e=c(35082);function f(...a){return(0,e.QP)((0,d.$)(a))}},20542:(a,b,c)=>{Promise.resolve().then(c.bind(c,17763))},28071:()=>{},36940:(a,b,c)=>{"use strict";c.d(b,{R:()=>d});let d={common:{loading:"Загрузка...",error:"Ошибка",save:"Сохранить",cancel:"Отмена",delete:"Удалить",edit:"Редактировать",create:"Создать",search:"Поиск",filter:"Фильтр",clear:"Очистить",apply:"Применить",close:"Закрыть",back:"Назад",next:"Далее",previous:"Назад",refresh:"Обновить",export:"Экспорт",import:"Импорт"},nav:{overview:"Обзор",inbox:"Входящие",calendar:"Календарь",orders:"Заказы",leads:"Лиды",customers:"Клиенты",team:"Команда",settings:"Настройки",audit:"Аудит"},roles:{owner:"Владелец",admin:"Администратор",staff:"Сотрудник",viewer:"Наблюдатель"},bot:{selectBot:"Выберите бота",switchBot:"Переключить бота",noBots:"Нет доступных ботов",context:"Контекст",role:"Роль"},inbox:{title:"Входящие",new:"Новые",inProgress:"В работе",done:"Выполнено",cancelled:"Отменено",unassigned:"Не назначено",assignToMe:"Назначить мне",markAsDone:"Отметить выполненным",createOrder:"Создать заказ",createLead:"Создать лид",createAppointment:"Создать запись",empty:"Нет событий",emptyDesc:"Все события будут отображаться здесь"},orders:{title:"Заказы",new:"Новые",processing:"В обработке",completed:"Завершено",cancelled:"Отменено",empty:"Нет заказов",emptyDesc:"Заказы будут отображаться здесь"},leads:{title:"Лиды",new:"Новые",contacted:"Связались",qualified:"Квалифицированы",converted:"Конвертированы",lost:"Потеряны",empty:"Нет лидов",emptyDesc:"Лиды будут отображаться здесь"},customers:{title:"Клиенты",empty:"Нет клиентов",emptyDesc:"Клиенты будут отображаться здесь"},calendar:{title:"Календарь",empty:"Нет записей",emptyDesc:"Записи будут отображаться здесь"},team:{title:"Команда",addMember:"Добавить участника",empty:"Нет участников",emptyDesc:"Добавьте участников команды"},settings:{title:"Настройки",general:"Общие",notifications:"Уведомления",integrations:"Интеграции"},audit:{title:"Аудит",empty:"Нет записей",emptyDesc:"История изменений будет отображаться здесь"},errors:{notFound:"Не найдено",unauthorized:"Требуется авторизация",forbidden:"Доступ запрещен",serverError:"Ошибка сервера",networkError:"Ошибка сети",unknown:"Неизвестная ошибка",requestId:"ID запроса",details:"Подробнее"},dashboard:{title:"Обзор",kpi:{newLeads:"Новые лиды",orders:"Заказы",revenue:"Выручка",conversion:"Конверсия"},trends:"Тренды",recent:"Недавние"}}},38031:(a,b,c)=>{"use strict";c.d(b,{n:()=>f});var d=c(41480),e=c(63366);function f(){return(0,d.I)({queryKey:["owner-me"],queryFn:e.qf,retry:!1})}},40889:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,84250,23)),Promise.resolve().then(c.t.bind(c,90285,23)),Promise.resolve().then(c.t.bind(c,16029,23)),Promise.resolve().then(c.t.bind(c,75380,23)),Promise.resolve().then(c.t.bind(c,68844,23)),Promise.resolve().then(c.t.bind(c,49648,23)),Promise.resolve().then(c.t.bind(c,50728,23)),Promise.resolve().then(c.t.bind(c,14193,23)),Promise.resolve().then(c.bind(c,63864))},63366:(a,b,c)=>{"use strict";c.d(b,{CK:()=>o,D6:()=>r,FO:()=>j,Kj:()=>q,Lu:()=>k,SJ:()=>m,qf:()=>l,w1:()=>p});var d=c(96767);let e="/api/core",f=null,g=d.Ik({user:d.Ik({telegramUserId:d.ai(),username:d.Yj().nullable().optional(),firstName:d.Yj().nullable().optional(),lastName:d.Yj().nullable().optional(),photoUrl:d.Yj().nullable().optional()}),bots:d.YO(d.Ik({botId:d.Yj(),name:d.Yj(),role:d.Yj()})),csrfToken:d.Yj()});async function h(a,b){let c=await fetch(a,{...b,credentials:"include",headers:{"Content-Type":"application/json",...b?.headers||{}},cache:"no-store"}),d=await c.json().catch(()=>({}));if(!c.ok)throw{code:d?.code||"request_failed",message:d?.message||"Ошибка запроса",request_id:d?.request_id,details:d?.details};return d}function i(a){return a.startsWith("/api/core/")?a:a.startsWith("/api/")?a.replace(/^\/api\//,"/api/core/"):a.startsWith("/")?`${e}${a}`:`${e}/${a}`}function j(a){return h(i("/api/owner/auth/telegram"),{method:"POST",body:JSON.stringify(a)})}function k(a){return h(i("/api/owner/auth/botlink"),{method:"POST",body:JSON.stringify({token:a})})}async function l(){let a=await h(i("/api/owner/auth/me")),b=g.parse(a);return f=b.csrfToken,b}function m(){return h(i("/api/owner/auth/logout"),{method:"POST"})}async function n(){if(f)return f;try{return(await l()).csrfToken||null}catch{return null}}async function o(a,b){let c=b?.method||"GET",d={};if("GET"!==c){let a=b?.csrfToken||await n();a&&(d["x-csrf-token"]=a)}return h(i(a),{method:c,headers:d,body:b?.body!==void 0?JSON.stringify(b.body):void 0})}async function p(){return h(i("/api/owner/summary"))}async function q(){return h(i("/api/owner/bots"))}async function r(a){return h(i(`/api/owner/bots/${a}`),{method:"DELETE"})}},79772:(a,b,c)=>{"use strict";c.d(b,{CabinetLayout:()=>d});let d=(0,c(34372).registerClientReference)(function(){throw Error("Attempted to call CabinetLayout() from the server but CabinetLayout is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/bogdan.rudenko/Desktop/lego_bot-main/packages/owner-web/src/components/cabinet-layout.tsx","CabinetLayout")},89432:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>h,metadata:()=>g});var d=c(16192);c(28071);var e=c(13009);function f(){let a=`
    (function(){
      try {
        var saved = localStorage.getItem('owner-theme');
        var systemDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        var dark = saved ? saved === 'dark' : systemDark;
        document.documentElement.classList.toggle('dark', dark);
      } catch (e) {}
    })();
  `;return(0,d.jsx)("script",{dangerouslySetInnerHTML:{__html:a}})}process.env.NEXT_PUBLIC_SENTRY_DSN;let g={title:"Owner Cabinet",description:"Owner Cabinet for Telegram bots"};function h({children:a}){return(0,d.jsxs)("html",{lang:"ru",suppressHydrationWarning:!0,children:[(0,d.jsxs)("head",{children:[(0,d.jsx)("meta",{httpEquiv:"X-Content-Type-Options",content:"nosniff"}),(0,d.jsx)("meta",{httpEquiv:"Referrer-Policy",content:"strict-origin-when-cross-origin"}),(0,d.jsx)("meta",{httpEquiv:"Permissions-Policy",content:"geolocation=(), microphone=(), camera=()"})]}),(0,d.jsxs)("body",{children:[(0,d.jsx)(f,{}),(0,d.jsx)(e.Providers,{children:a})]})]})}},93795:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>f});var d=c(16192),e=c(79772);function f({children:a}){return(0,d.jsx)(e.CabinetLayout,{children:a})}},96982:(a,b,c)=>{Promise.resolve().then(c.bind(c,13009))},97623:(a,b,c)=>{"use strict";c.d(b,{CabinetLayout:()=>o});var d=c(27986),e=c(63366),f=c(38031),g=c(2603),h=c(43185),i=c(81684),j=c(8019),k=c(36940);function l({bots:a,currentBotId:b}){let c=(0,i.useRouter)(),e=(0,i.usePathname)(),[f,h]=(0,g.useState)(!1),[l,m]=(0,g.useState)(""),n=(0,g.useRef)(null),o=a.find(a=>a.botId===b),p=l?a.filter(a=>a.name.toLowerCase().includes(l.toLowerCase())):a,q=o?k.R.roles[o.role]||o.role:"";return(0,d.jsxs)("div",{className:"relative",ref:n,children:[(0,d.jsxs)("button",{onClick:()=>h(!f),className:"flex items-center gap-2 px-3 py-2 rounded-lg border border-border bg-card hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors",children:[(0,d.jsxs)("div",{className:"text-left",children:[(0,d.jsx)("div",{className:"text-sm font-medium",children:o?.name||k.R.bot.selectBot}),o&&(0,d.jsxs)("div",{className:"text-xs text-muted-foreground",children:[k.R.bot.context,": ",o.name]})]}),o&&q&&(0,d.jsx)(j.E,{variant:"owner"===o.role?"success":"default",children:q}),(0,d.jsx)("svg",{className:`w-4 h-4 transition-transform ${f?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),f&&(0,d.jsxs)("div",{className:"absolute top-full left-0 mt-1 w-64 bg-card border border-border rounded-lg shadow-lg z-50 max-h-96 overflow-hidden flex flex-col",children:[(0,d.jsx)("div",{className:"p-2 border-b border-border",children:(0,d.jsx)("input",{type:"text",placeholder:k.R.common.search,value:l,onChange:a=>m(a.target.value),className:"w-full px-3 py-2 text-sm rounded border border-border bg-background focus:outline-none focus:ring-2 focus:ring-primary",autoFocus:!0})}),(0,d.jsx)("div",{className:"overflow-y-auto",children:0===p.length?(0,d.jsx)("div",{className:"p-4 text-sm text-muted-foreground text-center",children:k.R.bot.noBots}):p.map(a=>(0,d.jsx)("button",{onClick:()=>(a=>{h(!1),m("");let b=e.match(/\/cabinet\/[^/]+\/(.+)/),d=b?b[1]:"overview";c.push(`/cabinet/${a}/${d}`)})(a.botId),className:`w-full text-left px-3 py-2 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors ${a.botId===b?"bg-primary/10":""}`,children:(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:"text-sm font-medium",children:a.name}),(0,d.jsxs)("div",{className:"text-xs text-muted-foreground",children:["ID: ",a.botId.slice(0,8),"..."]})]}),(0,d.jsx)(j.E,{variant:"owner"===a.role?"success":"default",children:k.R.roles[a.role]||a.role})]})},a.botId))})]})]})}function m({botId:a}){let{isOpen:b,setIsOpen:c,search:e,setSearch:f,commands:h}=function(a){let b=(0,i.useRouter)();(0,i.usePathname)();let[c,d]=(0,g.useState)(!1),[e,f]=(0,g.useState)(""),h=a?[{id:"inbox",label:k.R.nav.inbox,shortcut:"g i",category:"Навигация",action:()=>{b.push(`/cabinet/${a}/inbox`),d(!1)}},{id:"calendar",label:k.R.nav.calendar,shortcut:"g k",category:"Навигация",action:()=>{b.push(`/cabinet/${a}/calendar`),d(!1)}},{id:"orders",label:k.R.nav.orders,shortcut:"g o",category:"Навигация",action:()=>{b.push(`/cabinet/${a}/orders`),d(!1)}},{id:"leads",label:k.R.nav.leads,category:"Навигация",action:()=>{b.push(`/cabinet/${a}/leads`),d(!1)}},{id:"customers",label:k.R.nav.customers,shortcut:"g c",category:"Навигация",action:()=>{b.push(`/cabinet/${a}/customers`),d(!1)}},{id:"overview",label:k.R.nav.overview,category:"Навигация",action:()=>{b.push(`/cabinet/${a}/overview`),d(!1)}},{id:"team",label:k.R.nav.team,category:"Навигация",action:()=>{b.push(`/cabinet/${a}/team`),d(!1)}},{id:"settings",label:k.R.nav.settings,category:"Навигация",action:()=>{b.push(`/cabinet/${a}/settings`),d(!1)}}]:[],j=e?h.filter(a=>a.label.toLowerCase().includes(e.toLowerCase())):h;return{isOpen:c,setIsOpen:d,search:e,setSearch:f,commands:j}}(a),j=(0,g.useRef)(null);return b?(0,d.jsxs)("div",{className:"fixed inset-0 z-50 flex items-start justify-center pt-[20vh]",children:[(0,d.jsx)("div",{className:"fixed inset-0 bg-black/50",onClick:()=>c(!1)}),(0,d.jsxs)("div",{className:"relative w-full max-w-2xl bg-card border border-border rounded-lg shadow-xl",children:[(0,d.jsx)("div",{className:"p-4 border-b border-border",children:(0,d.jsx)("input",{ref:j,type:"text",placeholder:"Поиск команд...",value:e,onChange:a=>f(a.target.value),className:"w-full bg-transparent outline-none text-lg"})}),(0,d.jsx)("div",{className:"max-h-96 overflow-y-auto",children:0===h.length?(0,d.jsx)("div",{className:"p-4 text-sm text-muted-foreground text-center",children:"Нет результатов"}):h.map(a=>(0,d.jsxs)("button",{onClick:a.action,className:"w-full text-left px-4 py-3 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors flex items-center justify-between",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:"font-medium",children:a.label}),(0,d.jsx)("div",{className:"text-xs text-muted-foreground",children:a.category})]}),a.shortcut&&(0,d.jsx)("kbd",{className:"px-2 py-1 text-xs bg-slate-100 dark:bg-slate-800 rounded",children:a.shortcut})]},a.id))})]})]}):null}let n=[{key:"overview",label:k.R.nav.overview},{key:"inbox",label:k.R.nav.inbox},{key:"calendar",label:k.R.nav.calendar},{key:"orders",label:k.R.nav.orders},{key:"leads",label:k.R.nav.leads},{key:"customers",label:k.R.nav.customers},{key:"team",label:k.R.nav.team},{key:"settings",label:k.R.nav.settings},{key:"audit",label:k.R.nav.audit}];function o({children:a}){let b=(0,i.useRouter)(),c=(0,i.usePathname)(),j=(0,i.useParams)(),{data:o,isLoading:p,isError:q}=(0,f.n)(),r=j?.botId;return(o?.bots?.find(a=>a.botId===r)||o?.bots?.[0],(0,i.useRouter)(),(0,h.jE)(),(0,g.useRef)(null),p||!o)?(0,d.jsx)("div",{className:"min-h-screen p-8",children:k.R.common.loading}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(m,{botId:r}),(0,d.jsxs)("div",{className:"min-h-screen grid grid-cols-[260px_1fr]",children:[(0,d.jsxs)("aside",{className:"border-r border-border bg-card p-5",children:[(0,d.jsx)("div",{className:"text-xl font-semibold",children:"Owner Cabinet"}),(0,d.jsx)("div",{className:"mt-1 text-sm text-muted-foreground",children:o.user.firstName||"Пользователь"}),(0,d.jsx)("div",{className:"mt-6 text-xs uppercase tracking-wide text-muted-foreground",children:"Разделы"}),(0,d.jsx)("nav",{className:"mt-2 space-y-1",children:n.map(a=>{let e=r?`/cabinet/${r}/${a.key}`:"/cabinet",f=c.startsWith(e);return(0,d.jsx)("button",{onClick:()=>b.push(e),className:`w-full text-left px-3 py-2 rounded-lg text-sm transition-colors ${f?"bg-primary text-white":"hover:bg-slate-100 dark:hover:bg-slate-800 text-foreground"}`,children:a.label},a.key)})}),(0,d.jsx)("button",{className:"mt-8 w-full text-left px-3 py-2 rounded-lg text-sm hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors",onClick:async()=>{await (0,e.SJ)(),b.replace("/login")},children:"Выйти"})]}),(0,d.jsxs)("div",{className:"p-6",children:[(0,d.jsxs)("header",{className:"panel px-4 py-3 flex items-center gap-3 justify-between mb-4",children:[(0,d.jsx)(l,{bots:o.bots||[],currentBotId:r}),(0,d.jsx)("input",{id:"global-search",placeholder:`${k.R.common.search} (/)`,className:"w-[360px] rounded-lg border border-border bg-background px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-primary",onChange:async a=>{if(!r)return;let b=a.target.value.trim();b&&await (0,e.CK)(`/api/owner/bots/${r}/events?q=${encodeURIComponent(b)}&limit=20`)}})]}),(0,d.jsx)("div",{children:a})]})]})]})}}};