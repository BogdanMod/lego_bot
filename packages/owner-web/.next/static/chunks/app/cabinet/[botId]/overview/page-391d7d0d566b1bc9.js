(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[174],{16144:(e,t,s)=>{"use strict";s.d(t,{CK:()=>h,D6:()=>f,FO:()=>o,Kj:()=>b,Lu:()=>c,SJ:()=>u,qf:()=>m,w1:()=>p});var r=s(13305);let a="/api/core",n=null,l=r.Ik({user:r.Ik({telegramUserId:r.ai(),username:r.Yj().nullable().optional(),firstName:r.Yj().nullable().optional(),lastName:r.Yj().nullable().optional(),photoUrl:r.Yj().nullable().optional()}),bots:r.YO(r.Ik({botId:r.Yj(),name:r.Yj(),role:r.Yj()})),csrfToken:r.Yj()});async function i(e,t){let s="undefined"!=typeof AbortController?new AbortController:null,r=s?setTimeout(()=>s.abort(),3e3):null;try{let a=await fetch(e,{...t,signal:null==s?void 0:s.signal,credentials:"include",headers:{"Content-Type":"application/json",...(null==t?void 0:t.headers)||{}},cache:"no-store"});r&&clearTimeout(r);let n=await a.json().catch(()=>({}));if(!a.ok)throw{code:(null==n?void 0:n.code)||"request_failed",message:(null==n?void 0:n.message)||"Ошибка запроса",request_id:null==n?void 0:n.request_id,details:null==n?void 0:n.details};return n}catch(e){if(r&&clearTimeout(r),(null==e?void 0:e.name)==="AbortError")throw{code:"timeout",message:"Request timeout (3000ms)"};throw e}}function d(e){return e.startsWith("/api/core/")?e:e.startsWith("/api/")?e.replace(/^\/api\//,"/api/core/"):e.startsWith("/")?"".concat(a).concat(e):"".concat(a,"/").concat(e)}function o(e){return i(d("/api/owner/auth/telegram"),{method:"POST",body:JSON.stringify(e)})}function c(e){return i(d("/api/owner/auth/botlink"),{method:"POST",body:JSON.stringify({token:e})})}async function m(){let e=await i(d("/api/owner/auth/me")),t=l.parse(e);return n=t.csrfToken,t}function u(){return i(d("/api/owner/auth/logout"),{method:"POST"})}async function x(){if(n)return n;try{return(await m()).csrfToken||null}catch(e){return null}}async function h(e,t){let s=(null==t?void 0:t.method)||"GET",r={};if("GET"!==s){let e=(null==t?void 0:t.csrfToken)||await x();e&&(r["x-csrf-token"]=e)}return i(d(e),{method:s,headers:r,body:(null==t?void 0:t.body)!==void 0?JSON.stringify(t.body):void 0})}async function p(){return i(d("/api/owner/summary"))}async function b(){return i(d("/api/owner/bots"))}async function f(e){return i(d("/api/owner/bots/".concat(e)),{method:"DELETE"})}},16851:(e,t,s)=>{"use strict";s.d(t,{E:()=>n});var r=s(33931),a=s(36669);function n(e){let{className:t,...s}=e;return(0,r.jsx)("div",{className:(0,a.cn)("animate-pulse rounded-md bg-slate-200 dark:bg-slate-800",t),...s})}},25427:(e,t,s)=>{Promise.resolve().then(s.bind(s,62669))},36669:(e,t,s)=>{"use strict";s.d(t,{cn:()=>n});var r=s(73682),a=s(72454);function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,a.QP)((0,r.$)(t))}},57023:(e,t,s)=>{"use strict";s.d(t,{E:()=>n});var r=s(33931),a=s(36669);function n(e){let{variant:t="default",children:s,className:n}=e;return(0,r.jsx)("span",{className:(0,a.cn)("inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium",{"bg-slate-100 text-slate-800 dark:bg-slate-800 dark:text-slate-200":"default"===t,"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"success"===t,"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":"warning"===t,"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200":"danger"===t,"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":"info"===t},n),children:s})}},62669:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>m});var r=s(33931),a=s(30883),n=s(16144),l=s(86804),i=s(16851),d=s(69646),o=s(65940),c=s(57023);function m(){var e,t,s;let m=(0,l.useParams)().botId,{data:u,isLoading:x,error:h}=(0,a.I)({queryKey:["dashboard",m],queryFn:()=>(0,n.CK)("/api/owner/bots/".concat(m,"/dashboard"))});if(x)return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)(i.E,{className:"h-32 w-full"}),(0,r.jsx)(i.E,{className:"h-64 w-full"})]});if(h)return(0,r.jsx)(d.p,{title:o.R.errors.serverError,description:"Не удалось загрузить данные обзора"});let p=(null==u?void 0:u.kpi)||{},b=(null==u?void 0:u.recent)||{};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-semibold mb-4",children:o.R.dashboard.title}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,r.jsxs)("div",{className:"panel p-4",children:[(0,r.jsx)("div",{className:"text-sm text-muted-foreground mb-1",children:o.R.dashboard.kpi.newLeads}),(0,r.jsx)("div",{className:"text-2xl font-bold",children:p.newLeads7d||0})]}),(0,r.jsxs)("div",{className:"panel p-4",children:[(0,r.jsx)("div",{className:"text-sm text-muted-foreground mb-1",children:o.R.dashboard.kpi.orders}),(0,r.jsx)("div",{className:"text-2xl font-bold",children:p.orders7d||0})]}),(0,r.jsxs)("div",{className:"panel p-4",children:[(0,r.jsx)("div",{className:"text-sm text-muted-foreground mb-1",children:o.R.dashboard.kpi.revenue}),(0,r.jsxs)("div",{className:"text-2xl font-bold",children:[p.revenue30d||0," ₽"]})]}),(0,r.jsxs)("div",{className:"panel p-4",children:[(0,r.jsx)("div",{className:"text-sm text-muted-foreground mb-1",children:o.R.dashboard.kpi.conversion}),(0,r.jsxs)("div",{className:"text-2xl font-bold",children:[p.conversion||0,"%"]})]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{className:"panel p-4",children:[(0,r.jsx)("h2",{className:"font-semibold mb-3",children:"Недавние лиды"}),(null==(e=b.leads)?void 0:e.length)>0?(0,r.jsx)("div",{className:"space-y-2",children:b.leads.map(e=>(0,r.jsxs)("div",{className:"text-sm",children:[(0,r.jsx)("div",{className:"font-medium",children:e.name||"Без имени"}),(0,r.jsx)("div",{className:"text-muted-foreground",children:e.phone||e.email||"Нет контакта"})]},e.id))}):(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:"Нет лидов"})]}),(0,r.jsxs)("div",{className:"panel p-4",children:[(0,r.jsx)("h2",{className:"font-semibold mb-3",children:"Недавние заказы"}),(null==(t=b.orders)?void 0:t.length)>0?(0,r.jsx)("div",{className:"space-y-2",children:b.orders.map(e=>(0,r.jsxs)("div",{className:"text-sm",children:[(0,r.jsxs)("div",{className:"font-medium",children:["Заказ #",e.id.slice(0,8)]}),(0,r.jsx)("div",{className:"text-muted-foreground",children:(0,r.jsx)(c.E,{variant:"completed"===e.status?"success":"default",children:e.status})})]},e.id))}):(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:"Нет заказов"})]}),(0,r.jsxs)("div",{className:"panel p-4",children:[(0,r.jsx)("h2",{className:"font-semibold mb-3",children:"Ближайшие записи"}),(null==(s=b.appointments)?void 0:s.length)>0?(0,r.jsx)("div",{className:"space-y-2",children:b.appointments.map(e=>(0,r.jsxs)("div",{className:"text-sm",children:[(0,r.jsx)("div",{className:"font-medium",children:new Date(e.startsAt).toLocaleString("ru-RU")}),(0,r.jsx)("div",{className:"text-muted-foreground",children:e.customerName||"Без имени"})]},e.id))}):(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:"Нет записей"})]})]})]})}},65940:(e,t,s)=>{"use strict";s.d(t,{R:()=>r});let r={common:{loading:"Загрузка...",error:"Ошибка",save:"Сохранить",cancel:"Отмена",delete:"Удалить",edit:"Редактировать",create:"Создать",search:"Поиск",filter:"Фильтр",clear:"Очистить",apply:"Применить",close:"Закрыть",back:"Назад",next:"Далее",previous:"Назад",refresh:"Обновить",export:"Экспорт",import:"Импорт"},nav:{overview:"Обзор",inbox:"Входящие",calendar:"Календарь",orders:"Заказы",leads:"Лиды",customers:"Клиенты",team:"Команда",settings:"Настройки",audit:"Аудит"},roles:{owner:"Владелец",admin:"Администратор",staff:"Сотрудник",viewer:"Наблюдатель"},bot:{selectBot:"Выберите бота",switchBot:"Переключить бота",noBots:"Нет доступных ботов",context:"Контекст",role:"Роль"},inbox:{title:"Входящие",new:"Новые",inProgress:"В работе",done:"Выполнено",cancelled:"Отменено",unassigned:"Не назначено",assignToMe:"Назначить мне",markAsDone:"Отметить выполненным",createOrder:"Создать заказ",createLead:"Создать лид",createAppointment:"Создать запись",empty:"Нет событий",emptyDesc:"Все события будут отображаться здесь"},orders:{title:"Заказы",new:"Новые",processing:"В обработке",completed:"Завершено",cancelled:"Отменено",empty:"Нет заказов",emptyDesc:"Заказы будут отображаться здесь"},leads:{title:"Лиды",new:"Новые",contacted:"Связались",qualified:"Квалифицированы",converted:"Конвертированы",lost:"Потеряны",empty:"Нет лидов",emptyDesc:"Лиды будут отображаться здесь"},customers:{title:"Клиенты",empty:"Нет клиентов",emptyDesc:"Клиенты будут отображаться здесь"},calendar:{title:"Календарь",empty:"Нет записей",emptyDesc:"Записи будут отображаться здесь"},team:{title:"Команда",addMember:"Добавить участника",empty:"Нет участников",emptyDesc:"Добавьте участников команды"},settings:{title:"Настройки",general:"Общие",notifications:"Уведомления",integrations:"Интеграции"},audit:{title:"Аудит",empty:"Нет записей",emptyDesc:"История изменений будет отображаться здесь"},errors:{notFound:"Не найдено",unauthorized:"Требуется авторизация",forbidden:"Доступ запрещен",serverError:"Ошибка сервера",networkError:"Ошибка сети",unknown:"Неизвестная ошибка",requestId:"ID запроса",details:"Подробнее"},dashboard:{title:"Обзор",kpi:{newLeads:"Новые лиды",orders:"Заказы",revenue:"Выручка",conversion:"Конверсия"},trends:"Тренды",recent:"Недавние"}}},69646:(e,t,s)=>{"use strict";s.d(t,{p:()=>l});var r=s(33931),a=s(36669);let n=(0,s(51259).forwardRef)((e,t)=>{let{className:s,variant:n="primary",size:l="md",...i}=e;return(0,r.jsx)("button",{ref:t,className:(0,a.cn)("inline-flex items-center justify-center rounded-lg font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary disabled:pointer-events-none disabled:opacity-50",{"bg-primary text-white hover:bg-primary/90":"primary"===n,"bg-slate-100 text-slate-900 hover:bg-slate-200 dark:bg-slate-800 dark:text-slate-100 dark:hover:bg-slate-700":"secondary"===n,"hover:bg-slate-100 dark:hover:bg-slate-800":"ghost"===n,"bg-red-500 text-white hover:bg-red-600":"danger"===n,"h-8 px-3 text-sm":"sm"===l,"h-10 px-4 text-sm":"md"===l,"h-12 px-6 text-base":"lg"===l},s),...i})});function l(e){let{title:t,description:s,action:a,icon:l}=e;return(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-16 px-4",children:[l&&(0,r.jsx)("div",{className:"mb-4 text-6xl opacity-50",children:l}),(0,r.jsx)("h3",{className:"text-lg font-semibold mb-2",children:t}),s&&(0,r.jsx)("p",{className:"text-sm text-muted-foreground mb-6 max-w-md text-center",children:s}),a&&(0,r.jsx)(n,{onClick:a.onClick,variant:"primary",children:a.label})]})}n.displayName="Button"}},e=>{e.O(0,[305,251,883,844,765,337,358],()=>e(e.s=25427)),_N_E=e.O()}]);