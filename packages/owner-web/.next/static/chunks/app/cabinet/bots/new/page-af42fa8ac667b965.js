(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[441],{16144:(e,t,s)=>{"use strict";s.d(t,{CK:()=>p,D6:()=>b,FO:()=>u,HP:()=>v,JD:()=>g,Kj:()=>f,Lu:()=>c,SJ:()=>m,qf:()=>d,w1:()=>x});var a=s(13305);let n="/api/core",i=null,r=a.Ik({user:a.Ik({telegramUserId:a.ai(),username:a.Yj().nullable().optional(),firstName:a.Yj().nullable().optional(),lastName:a.Yj().nullable().optional(),photoUrl:a.Yj().nullable().optional()}),bots:a.YO(a.Ik({botId:a.Yj(),name:a.Yj(),role:a.Yj()})),csrfToken:a.Yj()});async function o(e,t){let s="undefined"!=typeof AbortController?new AbortController:null,a=s?setTimeout(()=>s.abort(),3e3):null;try{let n=await fetch(e,{...t,signal:null==s?void 0:s.signal,credentials:"include",headers:{"Content-Type":"application/json",...(null==t?void 0:t.headers)||{}},cache:"no-store"});a&&clearTimeout(a);let r=await n.json().catch(()=>({}));if(!n.ok){let e=(null==r?void 0:r.message)||"Ошибка запроса",t=(null==r?void 0:r.code)||"request_failed";if("proxy_misconfigured"===t||e.includes("CORE_API_ORIGIN"))e="CORE_API_ORIGIN не настроен. Проверьте переменные окружения в Railway.";else if("misconfigured"===t&&e.includes("Owner auth is not configured")){let t=e.match(/missing ([^,]+(?:, [^,]+)*)/);e=t?"Owner auth не настроен: отсутствуют ".concat(t[1],". Проверьте переменные окружения в сервисе core."):"Owner auth не настроен. Проверьте JWT_SECRET и TELEGRAM_BOT_TOKEN в сервисе core."}if("csrf_failed"===t||"csrf_token_mismatch"===t){i=null;try{i=(await d()).csrfToken||null,e="CSRF токен обновлен. Попробуйте еще раз."}catch(t){e="Ошибка CSRF токена. Обновите страницу."}}else(401===n.status||403===n.status)&&("unauthorized"===t||"invalid_telegram_auth"===t)&&(e=e||"Требуется авторизация. Войдите через Telegram.");throw{code:t,message:e,request_id:null==r?void 0:r.request_id,details:null==r?void 0:r.details}}return r}catch(e){if(a&&clearTimeout(a),(null==e?void 0:e.name)==="AbortError")throw{code:"timeout",message:"Request timeout (3000ms)"};throw e}}function l(e){return e.startsWith("/api/core/")?e:e.startsWith("/api/")?e.replace(/^\/api\//,"/api/core/"):e.startsWith("/")?"".concat(n).concat(e):"".concat(n,"/").concat(e)}function u(e){return o(l("/api/owner/auth/telegram"),{method:"POST",body:JSON.stringify(e)})}function c(e,t){return o(l("/api/owner/auth/botlink"),{method:"POST",body:JSON.stringify({token:e,...t?{next:t}:{}})})}async function d(){let e=await o(l("/api/owner/auth/me")),t=r.parse(e);return i=t.csrfToken,t}function m(){return o(l("/api/owner/auth/logout"),{method:"POST"})}async function h(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(i&&!e)return i;try{return i=(await d()).csrfToken||null}catch(e){return i=null,null}}async function p(e,t){let s=(null==t?void 0:t.method)||"GET",a={};if("GET"!==s){let e=(null==t?void 0:t.csrfToken)||await h();e&&(a["x-csrf-token"]=e)}return o(l(e),{method:s,headers:a,body:(null==t?void 0:t.body)!==void 0?JSON.stringify(t.body):void 0})}async function x(){return o(l("/api/owner/summary"))}async function f(){return o(l("/api/owner/bots"))}async function b(e){return console.log(JSON.stringify({action:"owner_deactivate_bot",botId:e,timestamp:new Date().toISOString()})),await h(),p("/api/owner/bots/".concat(e),{method:"DELETE"})}async function g(){return p("/api/owner/templates")}async function v(e){return p("/api/owner/bots",{method:"POST",body:e})}},37935:(e,t,s)=>{"use strict";s.d(t,{n:()=>c});var a=s(51259),n=s(14860),i=s(28913),r=s(97194),o=s(92784),l=class extends r.Q{#e;#t=void 0;#s;#a;constructor(e,t){super(),this.#e=e,this.setOptions(t),this.bindMethods(),this.#n()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){let t=this.options;this.options=this.#e.defaultMutationOptions(e),(0,o.f8)(this.options,t)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#s,observer:this}),t?.mutationKey&&this.options.mutationKey&&(0,o.EN)(t.mutationKey)!==(0,o.EN)(this.options.mutationKey)?this.reset():this.#s?.state.status==="pending"&&this.#s.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#s?.removeObserver(this)}onMutationUpdate(e){this.#n(),this.#i(e)}getCurrentResult(){return this.#t}reset(){this.#s?.removeObserver(this),this.#s=void 0,this.#n(),this.#i()}mutate(e,t){return this.#a=t,this.#s?.removeObserver(this),this.#s=this.#e.getMutationCache().build(this.#e,this.options),this.#s.addObserver(this),this.#s.execute(e)}#n(){let e=this.#s?.state??(0,n.$)();this.#t={...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset}}#i(e){i.jG.batch(()=>{if(this.#a&&this.hasListeners()){let t=this.#t.variables,s=this.#t.context,a={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};if(e?.type==="success"){try{this.#a.onSuccess?.(e.data,t,s,a)}catch(e){Promise.reject(e)}try{this.#a.onSettled?.(e.data,null,t,s,a)}catch(e){Promise.reject(e)}}else if(e?.type==="error"){try{this.#a.onError?.(e.error,t,s,a)}catch(e){Promise.reject(e)}try{this.#a.onSettled?.(void 0,e.error,t,s,a)}catch(e){Promise.reject(e)}}}this.listeners.forEach(e=>{e(this.#t)})})}},u=s(84483);function c(e,t){let s=(0,u.jE)(t),[n]=a.useState(()=>new l(s,e));a.useEffect(()=>{n.setOptions(e)},[n,e]);let r=a.useSyncExternalStore(a.useCallback(e=>n.subscribe(i.jG.batchCalls(e)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),c=a.useCallback((e,t)=>{n.mutate(e,t).catch(o.lQ)},[n]);if(r.error&&(0,o.GU)(n.options.throwOnError,[r.error]))throw r.error;return{...r,mutate:c,mutateAsync:r.mutate}}},46829:(e,t,s)=>{"use strict";s.d(t,{CreateBotWizardClient:()=>x});var a=s(33931),n=s(86804),i=s(51259),r=s(84483),o=s(37935),l=s(43826),u=s(16144);function c(e,t){if("string"!=typeof e)return e;let s=e;for(let[e,a]of Object.entries(t)){let t=RegExp("\\{\\{".concat(e,"\\}\\}"),"g"),n=Array.isArray(a)?a.join(", "):String(null!=a?a:"");s=s.replace(t,n)}return s}function d(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a={...e,schema:function(e,t){let s=JSON.parse(JSON.stringify(e));for(let e in s.states){let a=s.states[e];a.message&&(a.message=c(a.message,t)),a.buttons&&(a.buttons=a.buttons.map(e=>({...e,text:c(e.text,t)})))}return s}(e.schema,t)};for(let e of s)a=function(e,t,s){let a=JSON.parse(JSON.stringify(e));switch(t){case"handoff":var n;a.schema.states.handoff||(a.schema.states.handoff={message:c("Свяжу вас с администратором. Опишите ваш вопрос, и мы ответим в ближайшее время.",s),buttons:[{text:"⬅️ Назад",nextState:a.schema.initialState}]});let i=a.schema.states[a.schema.initialState];!i||(null==(n=i.buttons)?void 0:n.some(e=>"handoff"===e.nextState))||(i.buttons=[...i.buttons||[],{text:"\uD83D\uDCAC Связаться с администратором",nextState:"handoff"}]);break;case"schedule":a.schema.states.schedule||(a.schema.states.schedule={message:c("Для записи укажите желаемое время и дату. Мы свяжемся с вами для подтверждения.",s),buttons:[{text:"⬅️ Назад",nextState:a.schema.initialState}]});break;case"faq":if(!a.schema.states.faq){let e=s.faqItems||[],t=e.length>0?"Частые вопросы:\n\n".concat(e.map((e,t)=>"".concat(t+1,". ").concat(e)).join("\n")):"Частые вопросы будут добавлены позже.";a.schema.states.faq={message:c(t,s),buttons:[{text:"⬅️ Назад",nextState:a.schema.initialState}]}}break;case"payments":a.schema.states.payment||(a.schema.states.payment={message:c("Для оплаты свяжитесь с нами: {{contactPhone}}",s),buttons:[{text:"⬅️ Назад",nextState:a.schema.initialState}]});break;case"catalog":a.schema.states.catalog||(a.schema.states.catalog={message:c("Каталог товаров/услуг:\n\n{{catalogItems}}",s),buttons:[{text:"⬅️ Назад",nextState:a.schema.initialState}]});break;case"leads":a.schema.states.lead||(a.schema.states.lead={message:c("Оставьте ваши контакты, и мы свяжемся с вами в ближайшее время.",s),buttons:[{text:"⬅️ Назад",nextState:a.schema.initialState}]})}return a}(a,e,t);return a}let m={id:"coffee_shop",name:"Кофейня / Кафе",description:"Прием заказов и бронирование столов",icon:"☕",version:"1.0.0",category:"business"},h={id:"beauty_salon",name:"Салон красоты",description:"Онлайн запись клиентов",icon:"\uD83D\uDC85",version:"1.0.0",category:"business"},p=[{manifest:m,wizard:{steps:[{id:"basic",title:"Базовая информация",description:"Основные данные о вашем заведении",fields:[{id:"businessName",label:"Название заведения",type:"text",required:!0,placeholder:"Например: Кофейня на углу",validation:{min:2,max:100}},{id:"address",label:"Адрес",type:"text",required:!0,placeholder:"Город, улица, дом"},{id:"contactPhone",label:"Контактный телефон",type:"phone",required:!0,placeholder:"+7 (999) 123-45-67"},{id:"workingHours",label:"Часы работы",type:"text",required:!1,placeholder:"Пн-Вс: 9:00 - 22:00"},{id:"menuUrl",label:"Ссылка на меню (опционально)",type:"url",required:!1,placeholder:"https://..."}]},{id:"offer",title:"Оффер",description:"Что ваш бот делает",fields:[{id:"offerDescription",label:"Краткое описание",type:"textarea",required:!1,placeholder:"Например: Принимаем заказы на вынос, бронируем столики, рассказываем об акциях",help:"Это описание будет использоваться в приветственном сообщении"}]}],modules:{handoff:!0,schedule:!0,faq:!0,payments:!1,catalog:!1,leads:!1}},buildBotConfig:function(e){let t=[];return e.enableHandoff&&t.push("handoff"),e.enableSchedule&&t.push("schedule"),e.enableFaq&&t.push("faq"),d({schema:{version:1,initialState:"start",states:{start:{message:"Добро пожаловать в {{businessName}}! ☕\n\nЧто вас интересует?",buttons:[{text:"\uD83D\uDCCB Меню",nextState:"menu"},{text:"\uD83D\uDED2 Заказать",nextState:"order"},{text:"\uD83E\uDE91 Забронировать стол",nextState:"booking"},{text:"\uD83C\uDF81 Акции",nextState:"promotions"},{text:"\uD83D\uDCDE Контакты",nextState:"contacts"}]},menu:{message:'\uD83D\uDCCB Наше меню:\n\n{{menuUrl}}\n\nДля заказа выберите "Заказать"',buttons:[{text:"\uD83D\uDED2 Заказать",nextState:"order"},{text:"⬅️ Назад",nextState:"start"}]},order:{message:"\uD83D\uDED2 Для оформления заказа свяжитесь с нами:\n\n\uD83D\uDCDE {{contactPhone}}\n\nИли оставьте заявку, и мы вам перезвоним!",buttons:[{text:"\uD83D\uDCDE Связаться",nextState:"handoff"},{text:"⬅️ Назад",nextState:"start"}]},booking:{message:"\uD83E\uDE91 Для бронирования столика укажите:\n• Дата и время\n• Количество гостей\n• Ваше имя и телефон\n\nМы свяжемся с вами для подтверждения!",buttons:[{text:"\uD83D\uDCC5 Забронировать",nextState:"schedule"},{text:"⬅️ Назад",nextState:"start"}]},promotions:{message:"\uD83C\uDF81 Текущие акции:\n\n• Скидка 10% на завтраки до 12:00\n• Каждый 5-й кофе в подарок\n• Скидка 15% при заказе от 1000₽\n\nСледите за новыми акциями!",buttons:[{text:"⬅️ Назад",nextState:"start"}]},contacts:{message:"\uD83D\uDCDE Контакты:\n\n\uD83D\uDCCD {{address}}\n\uD83D\uDCDE {{contactPhone}}\n\uD83D\uDD50 {{workingHours}}",buttons:[{text:"⬅️ Назад",nextState:"start"}]},help:{message:"Не понял ваш вопрос. Выберите один из вариантов выше или свяжитесь с администратором.",buttons:[{text:"⬅️ Назад",nextState:"start"}]}}},metadata:{template:{id:m.id,version:m.version}}},e,t)}},{manifest:h,wizard:{steps:[{id:"basic",title:"Базовая информация",fields:[{id:"businessName",label:"Название салона",type:"text",required:!0},{id:"address",label:"Адрес",type:"text",required:!0},{id:"contactPhone",label:"Контактный телефон",type:"phone",required:!0},{id:"workingHours",label:"Часы работы",type:"text",required:!1}]},{id:"offer",title:"Оффер",fields:[{id:"offerDescription",label:"Краткое описание услуг",type:"textarea",required:!1}]}],modules:{handoff:!0,schedule:!0,faq:!0,payments:!1,catalog:!1,leads:!1}},buildBotConfig:function(e){let t=[];return e.enableHandoff&&t.push("handoff"),e.enableSchedule&&t.push("schedule"),e.enableFaq&&t.push("faq"),d({schema:{version:1,initialState:"start",states:{start:{message:"Добро пожаловать в {{businessName}}! \uD83D\uDC85\n\nВыберите действие:",buttons:[{text:"\uD83D\uDCC5 Записаться",nextState:"booking"},{text:"\uD83D\uDCB0 Прайс-лист",nextState:"prices"},{text:"\uD83D\uDC69‍\uD83D\uDCBC Мастера",nextState:"masters"},{text:"\uD83D\uDCDE Контакты",nextState:"contacts"}]},booking:{message:"\uD83D\uDCC5 Для записи на услугу укажите желаемое время. Мы свяжемся с вами!",buttons:[{text:"\uD83D\uDCC5 Забронировать",nextState:"schedule"},{text:"⬅️ Назад",nextState:"start"}]},prices:{message:"\uD83D\uDCB0 Наши услуги и цены. Для уточнения свяжитесь с нами!",buttons:[{text:"\uD83D\uDCC5 Записаться",nextState:"booking"},{text:"⬅️ Назад",nextState:"start"}]},masters:{message:"\uD83D\uDC69‍\uD83D\uDCBC Наши мастера. При записи вы можете указать предпочтительного мастера!",buttons:[{text:"\uD83D\uDCC5 Записаться",nextState:"booking"},{text:"⬅️ Назад",nextState:"start"}]},contacts:{message:"\uD83D\uDCDE Контакты:\n\n\uD83D\uDCCD {{address}}\n\uD83D\uDCDE {{contactPhone}}\n\uD83D\uDD50 {{workingHours}}",buttons:[{text:"⬅️ Назад",nextState:"start"}]},help:{message:"Не понял ваш вопрос. Выберите один из вариантов выше.",buttons:[{text:"⬅️ Назад",nextState:"start"}]}}},metadata:{template:{id:h.id,version:h.version}}},e,t)}}];function x(e){let{wizardEnabled:t}=e,s=(0,n.useRouter)(),m=(0,n.useSearchParams)(),h=(0,r.jE)(),x="true"===m.get("template"),[f,b]=(0,i.useState)(0),[g,v]=(0,i.useState)(x?null:"empty"),[y,S]=(0,i.useState)({}),[N,j]=(0,i.useState)([]),w=t?p:[],k=(0,o.n)({mutationFn:u.HP,onSuccess:e=>{h.invalidateQueries({queryKey:["owner-bots"]}),h.invalidateQueries({queryKey:["owner-summary"]}),l.oR.success("Бот успешно создан"),s.push("/cabinet/".concat(e.bot.botId,"/overview"))},onError:e=>{if((null==e?void 0:e.code)==="bot_limit_reached"){var t,s;let a=e.details;l.oR.error("Лимит ботов достигнут: ".concat(null!=(t=null==a?void 0:a.activeBots)?t:"?","/").concat(null!=(s=null==a?void 0:a.limit)?s:"?"))}else l.oR.error((null==e?void 0:e.message)||"Ошибка при создании бота")}});if(!t)return(0,a.jsx)("div",{className:"panel p-8 max-w-2xl mx-auto",children:(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"text-2xl mb-4",children:"\uD83D\uDD12"}),(0,a.jsx)("h1",{className:"text-xl font-semibold mb-2",children:"Wizard выключен"}),(0,a.jsx)("p",{className:"text-muted-foreground mb-6",children:"Wizard создания ботов временно недоступен. Обратитесь к администратору."}),(0,a.jsx)("button",{onClick:()=>s.push("/cabinet/bots"),className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90",children:"Вернуться к списку ботов"})]})});if(x&&0===f)return(0,a.jsxs)("div",{className:"panel p-8 max-w-4xl mx-auto",children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold mb-6",children:"Выберите шаблон"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[w.map(e=>(0,a.jsxs)("button",{onClick:()=>{v(e.manifest.id),b(1)},className:"border rounded-lg p-4 hover:bg-slate-50 dark:hover:bg-slate-800 text-left",children:[(0,a.jsx)("div",{className:"text-2xl mb-2",children:e.manifest.icon}),(0,a.jsx)("div",{className:"font-medium mb-1",children:e.manifest.name}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:e.manifest.description})]},e.manifest.id)),(0,a.jsxs)("button",{onClick:()=>{v("empty"),b(1)},className:"border rounded-lg p-4 hover:bg-slate-50 dark:hover:bg-slate-800 text-left",children:[(0,a.jsx)("div",{className:"text-2xl mb-2",children:"➕"}),(0,a.jsx)("div",{className:"font-medium mb-1",children:"Создать с нуля"}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Пустой бот"})]})]}),(0,a.jsx)("button",{onClick:()=>s.back(),className:"mt-6 text-sm text-muted-foreground hover:text-foreground",children:"← Назад"})]});let O=g&&"empty"!==g?p.find(e=>e.manifest.id===g):null,C=(null==O?void 0:O.wizard.steps)||[{id:"basic",title:"Базовая информация",fields:[{id:"businessName",label:"Название бота",type:"text",required:!0}]}],R=C[f-!!x]||C[0],q=async()=>{try{let t;if(O)t=O.buildBotConfig(y);else{var e;e=y.businessName||"Мой бот",t={schema:{version:1,initialState:"start",states:{start:{message:c("Добро пожаловать в {{businessName}}!\n\nЧем можем помочь?",{...y,businessName:e}),buttons:[{text:"\uD83D\uDCAC Помощь",nextState:"help"}]},help:{message:"Для связи с администратором оставьте ваш вопрос.",buttons:[{text:"⬅️ Назад",nextState:"start"}]}}},metadata:{}}}N.length>0&&(t=d(t,y,N)),await k.mutateAsync({name:y.businessName||"Мой бот",timezone:y.timezone||"Europe/Moscow",language:y.language||"ru",config:{schema:t.schema,metadata:t.metadata},...O?{templateId:O.manifest.id,templateVersion:O.manifest.version}:{}})}catch(e){console.error("Failed to create bot:",e)}};return(0,a.jsxs)("div",{className:"panel p-8 max-w-2xl mx-auto",children:[(0,a.jsx)("button",{onClick:()=>s.back(),className:"mb-4 text-sm text-muted-foreground hover:text-foreground",children:"← Назад"}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold mb-2",children:"Создание бота"}),(0,a.jsx)("div",{className:"flex gap-2",children:C.map((e,t)=>(0,a.jsx)("div",{className:"flex-1 h-2 rounded ".concat(t<=f-!!x?"bg-primary":"bg-slate-200 dark:bg-slate-700")},t))})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h2",{className:"text-lg font-medium mb-2",children:R.title}),R.description&&(0,a.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:R.description}),(0,a.jsx)("div",{className:"space-y-4",children:R.fields.map(e=>(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium mb-2",children:[e.label,e.required&&(0,a.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),"textarea"===e.type?(0,a.jsx)("textarea",{value:y[e.id]||"",onChange:t=>S({...y,[e.id]:t.target.value}),placeholder:e.placeholder,className:"w-full rounded-lg border border-border bg-background px-3 py-2 outline-none focus:ring-2 focus:ring-primary",rows:4}):(0,a.jsx)("input",{type:"phone"===e.type?"tel":"email"===e.type?"email":"url"===e.type?"url":"text",value:y[e.id]||"",onChange:t=>S({...y,[e.id]:t.target.value}),placeholder:e.placeholder,className:"w-full rounded-lg border border-border bg-background px-3 py-2 outline-none focus:ring-2 focus:ring-primary"}),e.help&&(0,a.jsx)("div",{className:"text-xs text-muted-foreground mt-1",children:e.help})]},e.id))})]}),O&&f===C.length&&(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium mb-4",children:"Дополнительные модули"}),(0,a.jsx)("div",{className:"space-y-2",children:Object.entries(O.wizard.modules).map(e=>{let[t,s]=e;return s?(0,a.jsxs)("label",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",checked:N.includes(t),onChange:e=>{e.target.checked?j([...N,t]):j(N.filter(e=>e!==t))},className:"rounded"}),(0,a.jsxs)("span",{className:"text-sm",children:["handoff"===t&&"\uD83D\uDCAC Передача администратору","schedule"===t&&"\uD83D\uDCC5 Запись/расписание","faq"===t&&"❓ FAQ","payments"===t&&"\uD83D\uDCB3 Оплата","catalog"===t&&"\uD83D\uDCE6 Каталог","leads"===t&&"\uD83D\uDCDD Сбор лидов"]})]},t):null})})]}),(0,a.jsxs)("div",{className:"flex gap-3 justify-end",children:[f>+!!x&&(0,a.jsx)("button",{onClick:()=>b(f-1),className:"px-4 py-2 bg-slate-200 dark:bg-slate-700 text-slate-900 dark:text-slate-100 rounded-lg hover:bg-slate-300 dark:hover:bg-slate-600",children:"Назад"}),(0,a.jsx)("button",{onClick:f<C.length+0?()=>{let e=function(e,t){let s=[];for(let a of t){let t=e[a.id];if(a.required&&(null==t||""===t||Array.isArray(t)&&0===t.length)){s.push({field:a.id,message:'Поле "'.concat(a.id,'" обязательно для заполнения')});continue}null!=t&&a.validation&&("string"==typeof t&&(a.validation.min&&t.length<a.validation.min&&s.push({field:a.id,message:"Минимальная длина: ".concat(a.validation.min)}),a.validation.max&&t.length>a.validation.max&&s.push({field:a.id,message:"Максимальная длина: ".concat(a.validation.max)}),a.validation.pattern&&(new RegExp(a.validation.pattern).test(t)||s.push({field:a.id,message:"Неверный формат"}))),"number"==typeof t&&(void 0!==a.validation.min&&t<a.validation.min&&s.push({field:a.id,message:"Минимальное значение: ".concat(a.validation.min)}),void 0!==a.validation.max&&t>a.validation.max&&s.push({field:a.id,message:"Максимальное значение: ".concat(a.validation.max)})))}return{valid:0===s.length,errors:s}}(y,R.fields);if(!e.valid){var t;l.oR.error((null==(t=e.errors[0])?void 0:t.message)||"Заполните обязательные поля");return}f<C.length+ +!!x?b(f+1):q()}:q,disabled:k.isPending,className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90 disabled:opacity-50",children:f<C.length+0?"Далее":k.isPending?"Создание...":"Создать"})]})]})}},86804:(e,t,s)=>{"use strict";var a=s(41764);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})},93345:(e,t,s)=>{Promise.resolve().then(s.bind(s,46829))}},e=>{e.O(0,[305,163,957,765,337,358],()=>e(e.s=93345)),_N_E=e.O()}]);