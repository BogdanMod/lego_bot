# Environment Variables Example
# Copy this file to .env and fill in the values you need.

# ============================================
# QUICK START для Vercel Core Deployment
# ============================================
# 1. Создайте бота у @BotFather, получите TELEGRAM_BOT_TOKEN
# 2. Сгенерируйте TELEGRAM_SECRET_TOKEN: openssl rand -hex 32
# 3. Сгенерируйте ENCRYPTION_KEY: openssl rand -base64 32
# 4. Создайте БД на Neon.tech, скопируйте DATABASE_URL (Connection pooling)
# 5. (Опционально) Создайте Redis на Upstash.com, скопируйте REDIS_URL
# 6. Добавьте переменные в Vercel Dashboard → Settings → Environment Variables
# 7. Redeploy проект
# ============================================

# Минимальные переменные для Vercel Core (serverless):
# - DATABASE_URL (обязательно)
# - ENCRYPTION_KEY (обязательно)
# - TELEGRAM_BOT_TOKEN (обязательно)
# - TELEGRAM_SECRET_TOKEN (рекомендуется)

# ┌─────────────────────────┬──────────┬─────────────────────────────────────┐
# │ Variable                │ Required │ Used By                             │
# ├─────────────────────────┼──────────┼─────────────────────────────────────┤
# │ DATABASE_URL            │ ✓        │ Core, Router                        │
# │ ENCRYPTION_KEY          │ ✓        │ Core, Router                        │
# │ TELEGRAM_BOT_TOKEN      │ ✓        │ Core                                │
# │ TELEGRAM_SECRET_TOKEN   │ ~        │ Core (recommended)                  │
# │ REDIS_URL               │          │ Core, Router (optional)             │
# │ MINI_APP_URL            │          │ Core (optional, has fallback)       │
# │ ADMIN_USER_IDS          │          │ Core (optional)                     │
# │ VITE_API_URL            │ ✓        │ Mini App (production)               │
# │ VITE_API_URL_LOCAL      │          │ Mini App (local dev)                │
# │ NODE_ENV                │          │ All (local dev)                     │
# │ PORT                    │          │ Core/Router (local dev)             │
# └─────────────────────────┴──────────┴─────────────────────────────────────┘
# ✓ = Required, ~ = Recommended, (blank) = Optional

# ============================================
# ПРИМЕРЫ для популярных сервисов
# ============================================

# Neon (рекомендуется для Vercel)
# DATABASE_URL=postgresql://user:password@ep-xxx.us-east-2.aws.neon.tech/dbname?sslmode=require

# Supabase (с pooler для serverless)
# DATABASE_URL=postgresql://postgres:password@db.xxx.supabase.co:6543/postgres?pgbouncer=true&prepare_threshold=0

# Upstash Redis (serverless)
# REDIS_URL=rediss://default:password@xxx.upstash.io:6379

# Визуальная структура
# ```mermaid
# graph TD
#     A[.env.example] --> B[Quick Start Guide]
#     A --> C[Core Package - Vercel]
#     A --> D[Router Package - Docker]
#     A --> E[Mini App - Vite]
#     A --> F[Local Dev Only]
#
#     C --> C1[Required: DATABASE_URL]
#     C --> C2[Required: ENCRYPTION_KEY]
#     C --> C3[Required: TELEGRAM_BOT_TOKEN]
#     C --> C4[Recommended: TELEGRAM_SECRET_TOKEN]
#     C --> C5[Optional: REDIS_URL]
#     C --> C6[Optional: MINI_APP_URL]
#     C --> C7[Optional: ADMIN_USER_IDS]
#
#     D --> D1[Reuse Core vars]
#     D --> D2[PORT for router]
#
#     E --> E1[VITE_API_URL]
#     E --> E2[VITE_API_URL_LOCAL]
#
#     F --> F1[NODE_ENV]
#     F --> F2[PORT for core]
# ```

# === CORE PACKAGE (Vercel Serverless) ===

# Telegram Bot Token (Required)
# Получите у @BotFather в Telegram
# Формат: 123456789:ABCdefGHIjklMNOpqrsTUVwxyz
TELEGRAM_BOT_TOKEN=your-telegram-bot-token-here

# Webhook Secret Token (Recommended for production)
# Генерация: openssl rand -hex 32
# Или: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
TELEGRAM_SECRET_TOKEN=your-secret-token-here

# PostgreSQL Database URL (Required)
# Serverless-friendly сервисы:
# - Neon: https://neon.tech (рекомендуется, встроенный pooling)
# - Supabase: https://supabase.com (добавьте ?pgbouncer=true для pooler)
# - Vercel Postgres: https://vercel.com/storage/postgres
# Формат: postgresql://user:password@host:port/database
DATABASE_URL=postgresql://postgres:postgres@localhost:5433/dialogue_constructor

# Encryption Key для токенов ботов (Required, минимум 32 символа)
# Генерация: openssl rand -base64 32
# Или: node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"
ENCRYPTION_KEY=E4fAhUyp2RRUl9XjpjXwQw69OMtapnAxbh8KAZP7STM

# Redis URL (Optional, для кэширования)
# Serverless: Upstash Redis (https://upstash.com)
# Локально: redis://localhost:6379
# Приложение работает без Redis (graceful degradation)
REDIS_URL=redis://localhost:6379

# Mini App URL (Optional, есть fallback)
# Production: https://lego-bot-miniapp.vercel.app
# Используется в кнопках меню бота
MINI_APP_URL=https://lego-bot-miniapp.vercel.app

# Admin User IDs (Optional)
# Comma-separated Telegram user IDs для команды /setup_miniapp
# Если не задано, команда работает только для текущего чата
ADMIN_USER_IDS=123456789

# === ROUTER PACKAGE (Self-hosted, Docker) ===
# Используйте те же DATABASE_URL, ENCRYPTION_KEY, REDIS_URL что и для Core

# Router Server Port (Local development only)
# PORT=3001

# === MINI APP (Vite) ===

# Production API URL
VITE_API_URL=https://lego-bot-core.vercel.app

# Local Development API URL
VITE_API_URL_LOCAL=http://localhost:3000

# === LOCAL DEVELOPMENT ONLY ===

# Environment mode
NODE_ENV=development

# Core server port (local dev)
PORT=3000
